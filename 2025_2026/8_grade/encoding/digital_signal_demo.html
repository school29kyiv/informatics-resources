<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>–¶–∏—Ñ—Ä–æ–≤–∏–π —Å–∏–≥–Ω–∞–ª: –ø–µ—Ä–µ–¥–∞–π –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å 0/1</title>
<style>
  :root{
    --bg:#f8fafc;--text:#0f172a;--muted:#64748b;--card:#ffffff;
    --bar:#cbd5e1;--fill:#6366f1;--ok:#16a34a;--danger:#ef4444;--th:#11182722;
    --accent:#4f46e5;--ghost:#e2e8f0;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,sans-serif;background:var(--bg);color:var(--text)}
  .wrap{max-width:980px;margin:0 auto;padding:24px}
  h1{margin:0 0 6px;font-size:28px}
  p.lead{margin:0 0 14px;color:var(--muted)}
  .card{background:var(--card);border-radius:16px;box-shadow:0 2px 6px rgba(0,0,0,.08);padding:16px;margin: 16px 0;}
  .row{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .bar{height:22px;background:var(--bar);border-radius:12px;position:relative;overflow:hidden}
  .fill{position:absolute;left:0;top:0;bottom:0;width:0;background:var(--fill);transition:width .08s linear}
  .th{position:absolute;top:0;bottom:0;width:2px;background:var(--th)}
  .stat{font-size:14px;color:var(--muted)}
  .btn{border:0;border-radius:14px;padding:12px 16px;font-weight:700;cursor:pointer}
  .btn-prim{background:var(--accent);color:#fff}
  .btn-prim:active{transform:scale(0.98)}
  .btn-ghost{background:var(--ghost)}
  .hint{font-size:14px;color:var(--muted)}
  .seq{display:flex;gap:10px;flex-wrap:wrap}
  .bit, .bitOut{
    width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;
    font-weight:800;border:2px solid #e2e8f0;background:#f1f5f9;color:#334155
  }
  .bit.current{outline:3px solid var(--accent); outline-offset:2px}
  .bitOut.pending{background:#eef2ff;color:#3730a3;border-color:#c7d2fe}
  .bitOut.ok{background:#dcfce7;color:#166534;border-color:#86efac}
  .bitOut.bad{background:#fee2e2;color:#991b1b;border-color:#fecaca}
  .stateB{display:inline-flex;align-items:center;justify-content:center;width:88px;height:88px;border-radius:50%;color:#fff;font-size:40px;font-weight:800}
  .s0{background:var(--danger)} .s1{background:var(--ok)}
  .chips{display:flex;gap:8px;flex-wrap:wrap}
  .chip{background:#e2e8f0;border-radius:999px;padding:6px 10px;font-size:12px;color:#334155}
  .center{display:flex;gap:10px;align-items:center}
  .win{color:var(--ok);font-weight:800}
  .lose{color:var(--danger);font-weight:800}

  /* –ü—Ä–æ–≥—Ä–µ—Å –±—ñ—Ç–∞ */
  .bit-timer {display:grid;gap:6px;margin-top:10px}
  .bit-prog-wrap {height:10px;background:var(--ghost);border-radius:999px;overflow:hidden}
  .bit-prog {height:100%;width:0;background:var(--accent);transition:width .06s linear}
  .bit-time-row {display:flex;justify-content:space-between;font-size:13px;color:#475569}
</style>
</head>
<body>
  <div class="wrap">
    <h1>üíæ –¶–∏—Ñ—Ä–æ–≤–∏–π —Å–∏–≥–Ω–∞–ª: –ø–µ—Ä–µ–¥–∞–π –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å 0/1</h1>
    <p class="lead">–ü–µ—Ä–µ–¥–∞–π –∑–∞–¥–∞–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å 0 —Ç–∞ 1. –°–∏—Å—Ç–µ–º–∞ –∑—á–∏—Ç—É—î <b>–ø–æ —Ç–∞–∫—Ç–∞—Ö</b>. –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –æ–¥–Ω–æ–≥–æ —Ç–∞–∫—Ç–∞ - 2000 –º—Å. </p>

    <!-- –ê–Ω–∞–ª–æ–≥–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å (—à—É–º–∏—Ç—å), –∞–ª–µ –≤–∏—Ö—ñ–¥ –∑–∞–≤–∂–¥–∏ 0/1 –∑–∞ –ø–æ—Ä–æ–≥–æ–º -->
    <div class="card">
      <div class="row">
        <div class="stat">–ü–æ—Ä—ñ–≥: <b id="thVal">50</b></div>
        <div class="chips">
          <div class="chip">–Ø–∫—â–æ –≤ –∫—ñ–Ω—Ü—ñ —Ç–∞–∫—Ç—É –∑–Ω–∞—á–µ–Ω–Ω—è –º–µ–Ω—å—à–µ –ø–æ—Ä–æ–≥—É, —Ç–æ —Ü–µ —Å–∏–≥–Ω–∞–ª 0</div>
          <div class="chip">–ê —è–∫—â–æ –±—ñ–ª—å—à–µ, —Ç–æ —Ü–µ —Å–∏–≥–Ω–∞–ª 1</div>
        </div>
      </div>

      <div class="bar" style="margin:10px 0 8px;position:relative">
        <div id="thLine" class="th"></div>
        <div id="fill" class="fill"></div>
      </div>

      <div class="row" style="margin-top:8px">
        <div class="stat">–ê–Ω–∞–ª–æ–≥–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å: <b id="levelTxt">0.0</b></div>
        <div class="center">
          <span class="stat">–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω:</span>
          <div class="stateB s0" id="bitBubble"><span id="bitTxt">0</span></div>
        </div>
        <div class="stat">–¢–∞–∫—Ç–æ–≤–∏–π —ñ–Ω–¥–µ–∫—Å: <b id="idxTxt">‚Äî</b></div>
      </div>

      <!-- –¢–∞–π–º–µ—Ä –±—ñ—Ç–∞: —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —ñ —Å–∫—ñ–ª—å–∫–∏ –∑–∞–ª–∏—à–∏–ª–æ—Å—å -->
      <div class="bit-timer">
        <div class="bit-time-row">
          <span>‚è±Ô∏è –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ç–∞–∫—Ç—É: <b id="bitMsTxt">2000</b> –º—Å</span>
          <span>–ó–∞–ª–∏—à–∏–ª–æ—Å—å –¥–æ –∫—ñ–Ω—Ü—è —Ç–∞–∫—Ç—É: <b id="bitLeftTxt">‚Äî</b> –º—Å</span>
        </div>
        <div class="bit-prog-wrap" aria-label="–ø—Ä–æ–≥—Ä–µ—Å –ø–æ—Ç–æ—á–Ω–æ–≥–æ –±—ñ—Ç–∞">
          <div id="bitProg" class="bit-prog"></div>
        </div>
      </div>
    </div>

    <!-- –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ -->
    <div class="card">
      <div class="row">
        <div><b>–¶—ñ–ª—å–æ–≤–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å:</b></div>
        <div class="seq" id="targetSeq"></div>
      </div>
      <div class="row" style="margin-top:8px">
        <div><b>–¢–≤—ñ–π —Å–∏–≥–Ω–∞–ª:</b></div>
        <div class="seq" id="yourSeq"></div>
      </div>
    </div>

    <!-- –ö–µ—Ä—É–≤–∞–Ω–Ω—è -->
    <div class="card">
      <div class="row" style="gap:8px">
        <button class="btn btn-prim" id="startBtn">‚ñ∂Ô∏è –ü–æ—á–∞—Ç–∏ —Å–ø—Ä–æ–±—É</button>
        <button class="btn btn-ghost" id="nextBtn" disabled>üîÅ –ù–∞—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å</button>
        <div class="center">
          <button class="btn btn-prim" id="holdBtn">‚èØÔ∏è –£—Ç—Ä–∏–º—É–π = ¬´1¬ª, –≤—ñ–¥–ø—É—Å—Ç–∏ = ¬´0¬ª</button>
          <span class="hint">–°–∏—Å—Ç–µ–º–∞ —Ñ—ñ–∫—Å—É—î —Å—Ç–∞–Ω —É –∫—ñ–Ω—Ü—ñ –∫–æ–∂–Ω–æ–≥–æ –±—ñ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.</span>
        </div>
      </div>
      <div id="result" style="margin-top:10px;font-size:18px;"></div>
    </div>
  </div>

<script>
(function(){
  // –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ä–µ–∂–∏–º—É
  const TICK_MS   = 50;    // —ñ–Ω—Ç–µ—Ä–≤–∞–ª –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä—ñ–≤–Ω—è
  const NOISE_AMP = 1.2;   // —à—É–º –∞–Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ —Ä—ñ–≤–Ω—è
  const SPEED     = 1.1;   // –±–∞–∑–æ–≤–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–∏ —Ä—ñ–≤–Ω—è
  const UP_TARGET = 80;    // —Ü—ñ–ª—å —Ä—ñ–≤–Ω—è –ø—Ä–∏ —É—Ç—Ä–∏–º–∞–Ω–Ω—ñ
  const DN_TARGET = 20;    // —Ü—ñ–ª—å —Ä—ñ–≤–Ω—è –ø—Ä–∏ –≤—ñ–¥–ø—É—Å–∫–∞–Ω–Ω—ñ
  const THRESHOLD = 50;    // –ø–æ—Ä—ñ–≥ 0/1
  const BIT_MS    = 2000;   // —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –æ–¥–Ω–æ–≥–æ –±—ñ—Ç–∞ (–º—Å)
  const BIT_COUNT = 6;     // –¥–æ–≤–∂–∏–Ω–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ

  // –ï–ª–µ–º–µ–Ω—Ç–∏ DOM
  const fill     = document.getElementById('fill');
  const thLine   = document.getElementById('thLine');
  const thVal    = document.getElementById('thVal');
  const levelTxt = document.getElementById('levelTxt');
  const bitTxt   = document.getElementById('bitTxt');
  const bitBubble= document.getElementById('bitBubble');
  const idxTxt   = document.getElementById('idxTxt');
  const targetSeqEl = document.getElementById('targetSeq');
  const yourSeqEl   = document.getElementById('yourSeq');
  const startBtn = document.getElementById('startBtn');
  const nextBtn  = document.getElementById('nextBtn');
  const holdBtn  = document.getElementById('holdBtn');
  const bitMsTxt = document.getElementById('bitMsTxt');
  const bitLeftTxt = document.getElementById('bitLeftTxt');
  const bitProg  = document.getElementById('bitProg');
  const resultEl = document.getElementById('result');

  bitMsTxt.textContent = BIT_MS;

  // –°—Ç–∞–Ω
  let level = 0;         // –∞–Ω–∞–ª–æ–≥–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å (0..100)
  let holding = false;   // —á–∏ —É—Ç—Ä–∏–º—É—î–º–æ –∫–Ω–æ–ø–∫—É
  let loop = null;       // —Ç–∞–π–º–µ—Ä ¬´–∞–Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ¬ª —Ä—ñ–≤–Ω—è
  let running = false;   // —á–∏ –π–¥–µ —Å–ø—Ä–æ–±–∞
  let seqTimer = null;   // —Ç–∞–π–º–µ—Ä —Ç–∞–∫—Ç—ñ–≤
  let target = [];       // —Ü—ñ–ª—å–æ–≤–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å
  let yours  = [];       // –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (0/1)
  let bitIdx = -1;       // –ø–æ—Ç–æ—á–Ω–∏–π —Ç–∞–∫—Ç
  let attemptStart = 0;  // —á–∞—Å —Å—Ç–∞—Ä—Ç—É —Å–ø—Ä–æ–±–∏ (perf.now)
  let bitStart = 0;      // —á–∞—Å —Å—Ç–∞—Ä—Ç—É –ø–æ—Ç–æ—á–Ω–æ–≥–æ –±—ñ—Ç–∞ (perf.now)
  let rafId = null;      // –∞–Ω—ñ–º–∞—Ü—ñ—è –ø—Ä–æ–≥—Ä–µ—Å—É –±—ñ—Ç–∞

  function toBit(x){ return x >= THRESHOLD ? 1 : 0; }

  function layout(){
    const bar = fill.parentElement.getBoundingClientRect();
    const x = (THRESHOLD/100)*bar.width;
    thLine.style.left = (x - 1) + 'px';
    thVal.textContent = THRESHOLD;
  }

  function paintAnalog(){
    fill.style.width = level + '%';
    levelTxt.textContent = level.toFixed(1);
    const b = toBit(level);
    bitTxt.textContent = b;
    bitBubble.className = 'stateB ' + (b ? 's1' : 's0');
  }

  function tickAnalog(){
    const targetLv = holding ? UP_TARGET : DN_TARGET;
    const dir = Math.sign(targetLv - level);
    const jitter = (Math.random()*2 - 1) * NOISE_AMP;
    level = Math.max(0, Math.min(100, level + dir*SPEED + jitter));
    paintAnalog();
  }

  function startAnalog(){
    if (loop) return;
    loop = setInterval(tickAnalog, TICK_MS);
  }
  function stopAnalog(){
    if (!loop) return;
    clearInterval(loop);
    loop = null;
  }

  function newSequence(){
    target = Array.from({length:BIT_COUNT}, ()=> Math.random()<0.5 ? 0 : 1);
    yours  = Array.from({length:BIT_COUNT}, ()=> null);
    resultEl.textContent = '';
    renderSeq();
  }

  function renderSeq(){
    // target
    targetSeqEl.innerHTML = '';
    target.forEach((v,i)=>{
      const el = document.createElement('div');
      el.className = 'bit' + (i===bitIdx ? ' current':'');
      el.textContent = v;
      targetSeqEl.appendChild(el);
    });
    // your
    yourSeqEl.innerHTML = '';
    yours.forEach((v,i)=>{
      const el = document.createElement('div');
      const cls = v===null ? 'pending' : (v===target[i] ? 'ok':'bad');
      el.className = 'bitOut ' + cls + (i===bitIdx ? ' current':'' );
      el.textContent = v===null ? '¬∑' : v;
      yourSeqEl.appendChild(el);
    });
    idxTxt.textContent = running ? (bitIdx+1)+'/'+BIT_COUNT : '‚Äî';
  }

  function startAttempt(){
    if (running) return;
    running = true;
    bitIdx = -1;
    startBtn.disabled = true;
    nextBtn.disabled = true;

    attemptStart = performance.now();
    bitStart = attemptStart;
    stepBitTimer(); // –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∞–Ω—ñ–º–∞—Ü—ñ—é —Ç–∞–π–º–µ—Ä–∞ –±—ñ—Ç–∞

    seqTimer = setInterval(()=>{
      const t = performance.now() - attemptStart;
      const newIdx = Math.floor(t / BIT_MS);

      if (newIdx !== bitIdx){
        // –∑–∞–ø–∏—Å –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –±—ñ—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥—ñ —É –Ω–∞—Å—Ç—É–ø–Ω–∏–π
        if (bitIdx >= 0 && bitIdx < BIT_COUNT){
          yours[bitIdx] = toBit(level);
        }
        bitIdx = newIdx;
        bitStart = performance.now();  // —Å—Ç–∞—Ä—Ç –Ω–æ–≤–æ–≥–æ –±—ñ—Ç–∞ (–¥–ª—è —Ç–∞–π–º–µ—Ä–∞)
        if (bitIdx >= BIT_COUNT){
          endAttempt();
          return;
        }
        renderSeq();
      }
    }, 30);
  }

  function endAttempt(){
    running = false;
    clearInterval(seqTimer);
    seqTimer = null;
    cancelAnimationFrame(rafId);

    // —è–∫—â–æ –ª–∏—à–∏–≤—Å—è –Ω–µ–∑–∞–ø–∏—Å–∞–Ω–∏–π null ‚Äî –¥–æ–±–∏—Ä–∞—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω
    if (yours.includes(null)){
      const idx = yours.findIndex(v=>v===null);
      if (idx !== -1) yours[idx] = toBit(level);
    }
    renderSeq();

    const ok = yours.every((v,i)=> v===target[i]);
    resultEl.innerHTML = ok ? '<span class="win">‚úÖ –ü–µ—Ä–µ–º–æ–≥–∞! –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –ø–µ—Ä–µ–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.</span>'
                            : '<span class="lose">‚ùå –ü—Ä–æ–≥—Ä–∞—à. –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –Ω–µ –∑–±—ñ–≥–∞—î—Ç—å—Å—è.</span>';
    nextBtn.disabled = false; // –Ω–æ–≤–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –ø—ñ—Å–ª—è —Å–ø—Ä–æ–±–∏
  }

  // –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —á–∞—Å—É –ø–æ—Ç–æ—á–Ω–æ–≥–æ –±—ñ—Ç–∞
  function stepBitTimer(){
    // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–æ–≥—Ä–µ—Å/–∑–∞–ª–∏—à–æ–∫ —á–∞—Å—É –Ω–∞–≤—ñ—Ç—å –º—ñ–∂ ¬´–∫–≤–∞–Ω—Ç—É–≤–∞–Ω–Ω—è–º¬ª
    const now = performance.now();
    const elapsed = now - bitStart;
    const frac = Math.max(0, Math.min(1, elapsed / BIT_MS));
    const left = Math.max(0, BIT_MS - elapsed);

    bitProg.style.width = (frac*100) + '%';
    bitLeftTxt.textContent = Math.ceil(left).toString();

    if (running){
      rafId = requestAnimationFrame(stepBitTimer);
    } else {
      bitProg.style.width = '0%';
      bitLeftTxt.textContent = '‚Äî';
    }
  }

  // –ü–æ–¥—ñ—ó —É—Ç—Ä–∏–º–∞–Ω–Ω—è (–º–∏—à–∞ + —Ç–∞—á)
  holdBtn.addEventListener('mousedown', ()=>{ holding = true; });
  document.addEventListener('mouseup',   ()=>{ holding = false; });
  holdBtn.addEventListener('touchstart', (e)=>{ e.preventDefault(); holding = true; }, {passive:false});
  document.addEventListener('touchend',  (e)=>{ e.preventDefault(); holding = false; }, {passive:false});

  // –ö–µ—Ä—É–≤–∞–Ω–Ω—è —Ä–∞—É–Ω–¥–∞–º–∏
  startBtn.addEventListener('click', startAttempt);
  nextBtn.addEventListener('click', ()=>{
    newSequence();
    startBtn.disabled = false;
    nextBtn.disabled = true;
    bitIdx = -1;
    renderSeq();
    bitProg.style.width = '0%';
    bitLeftTxt.textContent = '‚Äî';
  });

  window.addEventListener('resize', ()=>layout());

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
  layout();
  paintAnalog();
  startAnalog();
  newSequence();
  renderSeq();
})();
</script>
</body>
</html>
